{
  "hash": "92038b065773140e99d9811344d58408",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Confirmatory Data Analysis (CDA)\"\nauthor: \"Jia Peng Chua | Zanelle Lee Wenfang\"\ndate-modified: \"last-modified\"\nexecute:\n    echo: true\n    eval: true\n    warning: false\n    freeze: true\n---\n\n\n\n\n# 1. Getting Started\n\n## 1.1 Loading R Packages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Loading R packages\"}\npacman::p_load(tidyverse, plotly, sf, tmap, GGally, ggstatsplot, ggmosaic)\n```\n:::\n\n\n\n\n## 1.2 Importing Dengue Dataset\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Importing Dengue_Daily dataset\"}\ndengue_daily <- read_csv(\"data/dengue_daily_en.csv\")\n\nsummary(dengue_daily)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Onset_Date            Gender           Age_Group        \n Min.   :1998-01-02   Length:106525      Length:106525     \n 1st Qu.:2014-10-30   Class :character   Class :character  \n Median :2015-09-30   Mode  :character   Mode  :character  \n Mean   :2016-04-21                                        \n 3rd Qu.:2023-07-18                                        \n Max.   :2025-03-07                                        \n                                                           \n Residential_County_City Residential_Town_District    X_coord     \n Length:106525           Length:106525             Min.   :118.3  \n Class :character        Class :character          1st Qu.:120.2  \n Mode  :character        Mode  :character          Median :120.3  \n                                                   Mean   :120.3  \n                                                   3rd Qu.:120.3  \n                                                   Max.   :122.0  \n                                                                  \n    Y_coord      Imported_Case        Serotype        \n Min.   :21.93   Length:106525      Length:106525     \n 1st Qu.:22.63   Class :character   Class :character  \n Median :22.96   Mode  :character   Mode  :character  \n Mean   :22.91                                        \n 3rd Qu.:23.00                                        \n Max.   :26.16                                        \n                                                      \n MOI_Residential_County_Code MOI_Residential_Town_Code   Onset_Year  \n Min.   :   63.0             Min.   : 900701           Min.   :1998  \n 1st Qu.:   64.0             1st Qu.:6400700           1st Qu.:2014  \n Median :   67.0             Median :6401700           Median :2015  \n Mean   :  540.6             Mean   :6283327           Mean   :2016  \n 3rd Qu.:   67.0             3rd Qu.:6703300           3rd Qu.:2023  \n Max.   :10020.0             Max.   :6801200           Max.   :2025  \n NA's   :476                 NA's   :476                             \n Onset_Epiweek \n Min.   : 1.0  \n 1st Qu.:36.0  \n Median :40.0  \n Mean   :39.8  \n 3rd Qu.:45.0  \n Max.   :53.0  \n               \n```\n\n\n:::\n:::\n\n\n\n\n# 2. Confirmatory Data Analysis (CDA)\n\n## 2.1 Does certain age group have significantly higher dengue cases compared to others?\n\nFirst, let's visualise the distribution of mean dengue cases by age groups.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nmean_age_group_year <- dengue_daily %>%\n    group_by(Age_Group, Onset_Year) %>%\n    summarize(Mean = mean(n()), .groups = \"drop\")\n\nggplot(mean_age_group_year, aes(x = Age_Group, y = Mean, fill = Age_Group)) +\n    geom_boxplot() +\n    labs(title = \"Distribution of Dengue Cases Across Age Groups\",\n         x = \"Age Group\",\n         y = \"Mean Dengue Cases per Year\")\n```\n\n::: {.cell-output-display}\n![](cda_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n### 2.1.1 Check if dengue cases are evenly distributed across age groups\n\nWe perform chi-square test using the sum of dengue cases by age group.\n\n-   H~0~: The number of dengue cases is independent of age group\n\n-   H~1~: The number of dengue cases depends on age group\n\n::: panel-tabset\n#### Chi-Square test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nsum_age_group <- dengue_daily %>%\n    group_by(Age_Group) %>%\n    summarize(Count = n(), .groups = \"drop\")\n\nchisq.test(sum_age_group$Count)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  sum_age_group$Count\nX-squared = 18827, df = 14, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n#### Visual\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nggbetweenstats(\n    data = sum_age_group,\n    x = Age_Group, \n    y = Count,\n    type = \"np\",\n    mean.ci = TRUE, \n    p.adjust.method = \"fdr\",\n    messages = FALSE\n    )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"All values of t are equal to  1 \\n Cannot calculate confidence intervals\"\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](cda_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nConclusion:\n\n-   Since p-value is \\< 0.05, we reject the null hypothesis at 5% significance level.\n\n-   This suggests that the number of dengue cases varies significantly across different age groups.\n\n### 2.1.2 Check if dengue cases are evenly distributed across age groups over the years\n\nWe perform chi-square test using the sum of dengue cases by age group.\n\n-   H~0~: The distribution of dengue cases across age group does not change over the years\n\n-   H~1~: The distribution of dengue cases across age group changes over the years\n\n::: panel-tabset\n#### Chi-square test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nsum_age_group_year <- dengue_daily %>%\n    group_by(Age_Group, Onset_Year) %>%\n    summarize(Count = n(), .groups = \"drop\")\n\nsum_age_group_year_table <- table(sum_age_group_year$Age_Group, \n                                  sum_age_group_year$Onset_Year)\n\nchisq.test(sum_age_group_year_table)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  sum_age_group_year_table\nX-squared = 18.651, df = 378, p-value = 1\n```\n\n\n:::\n:::\n\n\n\n\n#### Visual\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nggbetweenstats(\n    data = sum_age_group_year,\n    x = Age_Group, \n    y = Count,\n    type = \"p\",\n    mean.ci = TRUE, \n    pairwise.comparisons = TRUE, \n    pairwise.display = \"s\",\n    p.adjust.method = \"fdr\",\n    messages = FALSE\n    )\n```\n\n::: {.cell-output-display}\n![](cda_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nConclusion:\n\n-   Since p-value is \\> 0.05, we do not reject the null hypothesis at 5% significance level.\n\n-   This suggests that the number of dengue cases does not change across different age groups over the years.\n\n### 2.1.3 Check if the average number of dengue cases differs by age group\n\nWe perform Kruskal-Wallis test using the mean of dengue cases by age group.\n\n-   H~0~: The mean number of dengue cases per year is the same across all age groups\n\n-   H~1~: The mean number of dengue cases per year is the differs across all age groups\n\n::: panel-tabset\n#### Kruskal-Wallis test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\ngroup_by_age <- dengue_daily %>%\n    group_by(Age_Group, Onset_Year) %>%\n    summarize(Count = n(), .groups = \"drop\")\n\nkruskal.test(Count ~ Age_Group, data = group_by_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  Count by Age_Group\nKruskal-Wallis chi-squared = 34.982, df = 14, p-value = 0.001479\n```\n\n\n:::\n:::\n\n\n\n\n#### Visual\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nggbetweenstats(\n    data = group_by_age,\n    x = Age_Group, \n    y = Count,\n    type = \"p\",\n    mean.ci = TRUE, \n    pairwise.comparisons = TRUE, \n    pairwise.display = \"s\",\n    p.adjust.method = \"fdr\",\n    messages = FALSE\n    )\n```\n\n::: {.cell-output-display}\n![](cda_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nConclusion:\n\n-   Since p-value is \\< 0.05, we reject the null hypothesis at 5% significance level.\n\n-   This suggests that the mean number of dengue cases differs across different age groups.\n\n## 2.2 How do other factors such as gender, imported cases, serotype and geographic distribution influence the number of dengue cases?\n\n### 2.2.1 Gender\n\n-   H~0~: There is no difference in the number of dengue cases between male and female\n\n-   H~1~: There is a difference in the number of dengue cases between male and female\n\n::: panel-tabset\n#### T-test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\ngroup_by_gender <- dengue_daily %>%\n    group_by(Gender, Onset_Year) %>%\n    summarize(Count = n(), .groups = \"drop\")\n\ngroup_by_gender_test <- group_by_gender %>%\n    filter(Gender %in% c(\"F\", \"M\"))\n\nt_test_gender <- t.test(Count ~ Gender, data = group_by_gender_test)\n\nt_test_gender\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  Count by Gender\nt = -0.058509, df = 53.945, p-value = 0.9536\nalternative hypothesis: true difference in means between group F and group M is not equal to 0\n95 percent confidence interval:\n -2652.601  2502.172\nsample estimates:\nmean in group F mean in group M \n       1864.607        1939.821 \n```\n\n\n:::\n:::\n\n\n\n\n#### Two-sample mean test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nggbetweenstats(\n    data = group_by_gender_test,\n    x = Gender, \n    y = Count,\n    type = \"np\",\n    messages = FALSE\n    )\n```\n\n::: {.cell-output-display}\n![](cda_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nConclusion:\n\n-   Since p-value is \\> 0.05, we do not reject the null hypothesis at 5% significance level.\n\n-   This suggests that there is no difference in the number of dengue cases between male and female.\n\n### 2.2.2 Imported Cases\n\n-   H~0~: There is no difference in the number of dengue cases between imported and local cases\n\n-   H~1~: There is a difference in the number of dengue cases between imported and local cases\n\n::: panel-tabset\n#### T-test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\ngroup_by_imported <- dengue_daily %>%\n    group_by(Imported_Case, Onset_Year) %>%\n    summarize(Count = n(), .groups = \"drop\")\n\nt_test_gender <- t.test(Count ~ Imported_Case, data = group_by_imported)\n\nt_test_gender\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  Count by Imported_Case\nt = 1.9374, df = 25.008, p-value = 0.06407\nalternative hypothesis: true difference in means between group No and group Yes is not equal to 0\n95 percent confidence interval:\n -236.8206 7750.2656\nsample estimates:\n mean in group No mean in group Yes \n        3920.6154          163.8929 \n```\n\n\n:::\n:::\n\n\n\n\n#### Two-sample mean test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nggbetweenstats(\n    data = group_by_imported,\n    x = Imported_Case, \n    y = Count,\n    type = \"np\",\n    messages = FALSE\n    )\n```\n\n::: {.cell-output-display}\n![](cda_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nConclusion:\n\n-   Since p-value is < 0.10, we reject the null hypothesis at 10% significance level.\n\n-   This suggests that there is significant difference in the number of dengue cases between imported and local cases.\n\n### 2.2.3 Serotype\n\n-   H~0~: There is no difference in the number of dengue cases between different serotypes\n\n-   H~1~: There is a difference in the number of dengue cases between different serotypes\n\n::: panel-tabset\n#### One-way ANOVA test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\ngroup_by_serotype <- dengue_daily %>%\n    group_by(Serotype, Onset_Year) %>%\n    summarize(Count = n(), .groups = \"drop\")\n\n# Excluding data with missing Serotype\ngroup_by_serotype_test <- group_by_serotype %>% filter(!is.na(Serotype))\n\nanova_serotype <- aov(Count ~ Serotype, data = group_by_serotype_test)\n\nsummary(anova_serotype)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df   Sum Sq Mean Sq F value Pr(>F)\nSerotype      3   821472  273824   1.788  0.154\nResiduals   104 15931323  153186               \n```\n\n\n:::\n:::\n\n\n\n\n#### Visual\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nggbetweenstats(\n    data = group_by_serotype_test,\n    x = Serotype, \n    y = Count,\n    type = \"p\",\n    mean.ci = TRUE, \n    pairwise.comparisons = TRUE, \n    pairwise.display = \"s\",\n    p.adjust.method = \"fdr\",\n    messages = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](cda_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nConclusion:\n\n-   Since p-value is \\> 0.05, we do not reject the null hypothesis at 5% significance level.\n\n-   This suggests that there is no difference in the number of dengue cases between different serotypes.\n\n### 2.2.4 Geographic Distribution\n\n-   H~0~: There is no difference in the number of dengue cases between county cities\n\n-   H~1~: There is a difference in the number of dengue cases between county cities\n\n::: panel-tabset\n#### One-way ANOVA test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\ngroup_by_county <- dengue_daily %>%\n    group_by(Residential_County_City, Onset_Year) %>%\n    summarize(Count = n(), .groups = \"drop\")\n\nkruskal.test(Count ~ Residential_County_City, data = group_by_county)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  Count by Residential_County_City\nKruskal-Wallis chi-squared = 216.98, df = 21, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n#### Visual\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code\"}\nggbetweenstats(\n    data = group_by_county,\n    x = Residential_County_City, \n    y = Count,\n    type = \"p\",\n    mean.ci = TRUE, \n    pairwise.comparisons = TRUE, \n    pairwise.display = \"s\",\n    p.adjust.method = \"fdr\",\n    messages = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](cda_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\nConclusion:\n\n-   Since p-value is \\< 0.05, we reject the null hypothesis at 5% significance level.\n\n-   This suggests that there is significant difference in the number of dengue cases between county cities.\n",
    "supporting": [
      "cda_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}