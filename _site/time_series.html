<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jia Peng Chua | Zanelle Lee Wenfang">

<title>Time Series – Buzzzz LightYears</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-bd8cb2610f6c2810c4bc87234a365cf8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Buzzzz LightYears</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://buzzzzlightyear.netlify.app/"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-documentations" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Documentations</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-documentations">    
        <li>
    <a class="dropdown-item" href="./proposal_revised.html">
 <span class="dropdown-text">Project Proposal (Revised)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./proposal.html">
 <span class="dropdown-text">Project Proposal (Initial)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Minutes/meeting_minutes_1.html">
 <span class="dropdown-text">Meeting Minutes 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Minutes/meeting_minutes_2.html">
 <span class="dropdown-text">Meeting Minutes 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Minutes/meeting_minutes_3.html">
 <span class="dropdown-text">Meeting Minutes 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Minutes/meeting_minutes_4.html">
 <span class="dropdown-text">Meeting Minutes 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysis" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analysis</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysis">    
        <li>
    <a class="dropdown-item" href="./data_preparation.html">
 <span class="dropdown-text">Data Preparation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eda.html">
 <span class="dropdown-text">Exploratory Data Analysis (EDA)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./cda.html">
 <span class="dropdown-text">Confirmatory Data Analysis (CDA)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./time_series.html">
 <span class="dropdown-text">Time Series Analysis</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#loading-r-packages-and-data-preparation" id="toc-loading-r-packages-and-data-preparation" class="nav-link active" data-scroll-target="#loading-r-packages-and-data-preparation">1. Loading R Packages and Data Preparation</a></li>
  <li><a href="#week-based-curve-fitting" id="toc-week-based-curve-fitting" class="nav-link" data-scroll-target="#week-based-curve-fitting">2. Week-based Curve Fitting</a>
  <ul class="collapse">
  <li><a href="#outbreak-year-2014" id="toc-outbreak-year-2014" class="nav-link" data-scroll-target="#outbreak-year-2014">2.1. Outbreak Year 2014</a>
  <ul class="collapse">
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">2.1.1. Model Comparison</a></li>
  <li><a href="#cumulative-model-comparison" id="toc-cumulative-model-comparison" class="nav-link" data-scroll-target="#cumulative-model-comparison">2.1.2. Cumulative Model Comparison</a></li>
  </ul></li>
  <li><a href="#outbreak-year-2015" id="toc-outbreak-year-2015" class="nav-link" data-scroll-target="#outbreak-year-2015">2.2. Outbreak Year 2015</a>
  <ul class="collapse">
  <li><a href="#model-comparison-1" id="toc-model-comparison-1" class="nav-link" data-scroll-target="#model-comparison-1">2.2.1. Model Comparison</a></li>
  <li><a href="#cumulative-model-comparison-1" id="toc-cumulative-model-comparison-1" class="nav-link" data-scroll-target="#cumulative-model-comparison-1">2.2.2. Cumulative Model Comparison</a></li>
  </ul></li>
  <li><a href="#outbreak-year-2023" id="toc-outbreak-year-2023" class="nav-link" data-scroll-target="#outbreak-year-2023">2.3. Outbreak Year 2023</a>
  <ul class="collapse">
  <li><a href="#model-comparison-2" id="toc-model-comparison-2" class="nav-link" data-scroll-target="#model-comparison-2">2.3.1. Model Comparison</a></li>
  <li><a href="#cumulative-model-comparison-2" id="toc-cumulative-model-comparison-2" class="nav-link" data-scroll-target="#cumulative-model-comparison-2">2.3.2. Cumulative Model Comparison</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#progress-based-curve-fitting" id="toc-progress-based-curve-fitting" class="nav-link" data-scroll-target="#progress-based-curve-fitting">3. Progress-based Curve fitting</a>
  <ul class="collapse">
  <li><a href="#using-2014-outbreak-wave-1" id="toc-using-2014-outbreak-wave-1" class="nav-link" data-scroll-target="#using-2014-outbreak-wave-1">3.1. Using 2014 Outbreak (Wave 1)</a></li>
  <li><a href="#using-2015-outbreak-wave-2" id="toc-using-2015-outbreak-wave-2" class="nav-link" data-scroll-target="#using-2015-outbreak-wave-2">3.2. Using 2015 Outbreak (Wave 2)</a></li>
  <li><a href="#using-2023-outbreak-wave-3" id="toc-using-2023-outbreak-wave-3" class="nav-link" data-scroll-target="#using-2023-outbreak-wave-3">3.3. Using 2023 Outbreak (Wave 3)</a></li>
  <li><a href="#cumulative-model-comparison-using-rmse" id="toc-cumulative-model-comparison-using-rmse" class="nav-link" data-scroll-target="#cumulative-model-comparison-using-rmse">3.4. Cumulative Model Comparison using RMSE</a>
  <ul class="collapse">
  <li><a href="#predicting-2014-outbreak" id="toc-predicting-2014-outbreak" class="nav-link" data-scroll-target="#predicting-2014-outbreak">3.4.1. Predicting 2014 Outbreak</a></li>
  <li><a href="#predicting-2015-outbreak" id="toc-predicting-2015-outbreak" class="nav-link" data-scroll-target="#predicting-2015-outbreak">3.4.2. Predicting 2015 Outbreak</a></li>
  <li><a href="#predicting-2023-outbreak" id="toc-predicting-2023-outbreak" class="nav-link" data-scroll-target="#predicting-2023-outbreak">3.4.3. Predicting 2023 Outbreak</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Time Series</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jia Peng Chua | Zanelle Lee Wenfang </p>
          </div>
  </div>
    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">April 3, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="loading-r-packages-and-data-preparation" class="level1">
<h1>1. Loading R Packages and Data Preparation</h1>
<p>First, we load the appropriate R packages that are necessary for the exploration of the dataset, as well as for its analysis and time series usage. In this segment, we will be loading <strong>tidyverse</strong>, <strong>MASS</strong>, <strong>mgcv</strong>, and <strong>Metrics</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for loading R packages</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, plotly, MASS, mgcv, Metrics, gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The dataset is loaded into <em>dengue_daily</em>, and <em>summary()</em> is used to get a rough idea on the dataset and its variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for loading dataset</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dengue_daily <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/Dengue_Daily.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dengue_daily)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     發病日             個案研判日             通報日          
 Min.   :1998-01-02   Min.   :2004-05-16   Min.   :1998-01-07  
 1st Qu.:2014-10-29   1st Qu.:2014-11-28   1st Qu.:2014-10-31  
 Median :2015-09-29   Median :2015-10-10   Median :2015-10-01  
 Mean   :2016-04-13   Mean   :2017-02-27   Mean   :2016-04-16  
 3rd Qu.:2023-07-10   3rd Qu.:2023-08-18   3rd Qu.:2023-07-13  
 Max.   :2025-03-16   Max.   :2025-03-16   Max.   :2025-03-16  
                      NA's   :6279                             
     性別              年齡層            居住縣市           居住鄉鎮        
 Length:107312      Length:107312      Length:107312      Length:107312     
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
   居住村里          最小統計區        最小統計區中心點X 最小統計區中心點Y
 Length:107312      Length:107312      Min.   :118.3     Min.   :21.93    
 Class :character   Class :character   1st Qu.:120.2     1st Qu.:22.63    
 Mode  :character   Mode  :character   Median :120.3     Median :22.96    
                                       Mean   :120.3     Mean   :22.91    
                                       3rd Qu.:120.3     3rd Qu.:23.00    
                                       Max.   :122.0     Max.   :26.16    
                                       NA's   :789       NA's   :789      
  一級統計區         二級統計區          感染縣市           感染鄉鎮        
 Length:107312      Length:107312      Length:107312      Length:107312     
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
   感染村里         是否境外移入         感染國家           確定病例數
 Length:107312      Length:107312      Length:107312      Min.   :1   
 Class :character   Class :character   Class :character   1st Qu.:1   
 Mode  :character   Mode  :character   Mode  :character   Median :1   
                                                          Mean   :1   
                                                          3rd Qu.:1   
                                                          Max.   :2   
                                                                      
 居住村里代碼       感染村里代碼          血清型          內政部居住縣市代碼
 Length:107312      Length:107312      Length:107312      Min.   :   63.0   
 Class :character   Class :character   Class :character   1st Qu.:   64.0   
 Mode  :character   Mode  :character   Mode  :character   Median :   67.0   
                                                          Mean   :  546.3   
                                                          3rd Qu.:   67.0   
                                                          Max.   :10020.0   
                                                          NA's   :476       
 內政部居住鄉鎮代碼 內政部感染縣市代碼 內政部感染鄉鎮代碼
 Min.   : 900701    Min.   :   63      Min.   :1000202   
 1st Qu.:6400700    1st Qu.:   64      1st Qu.:6400700   
 Median :6401800    Median :   66      Median :6401600   
 Mean   :6281126    Mean   :  359      Mean   :6384118   
 3rd Qu.:6703300    3rd Qu.:   67      3rd Qu.:6703300   
 Max.   :6801200    Max.   :10020      Max.   :6801000   
 NA's   :476        NA's   :19108      NA's   :19108     </code></pre>
</div>
</div>
<p>As this is a Taiwan dataset, it is not surprising that most of the data is recorded in Mandarin. For easier referencing and usage of the dataset, the column names are translated to English.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for columns translation</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dengue_daily) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Onset_Date"</span>, <span class="st">"Case_Classification_Date"</span>, <span class="st">"Reporting_Date"</span>, <span class="st">"Gender"</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Age_Group"</span>, <span class="st">"Residential_County_City"</span>, <span class="st">"Residential_Town_District"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Residential_Village"</span>, <span class="st">"Smallest_Statistical_Area"</span>, <span class="st">"X_coord"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Y_coord"</span>, <span class="st">"Primary_Statistical_Area"</span>, <span class="st">"Secondary_Statistical_Area"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Infection_County_City"</span>, <span class="st">"Infection_Town_District"</span>, <span class="st">"Infection_Village"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Imported_Case"</span>, <span class="st">"Infection_Country"</span>, <span class="st">"Confirmed_Cases"</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Residential_Village_Code"</span>, <span class="st">"Infection_Village_Code"</span>, <span class="st">"Serotype"</span>, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"MOI_Residential_County_Code"</span>, <span class="st">"MOI_Residential_Town_Code"</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"MOI_Infection_County_Code"</span>, <span class="st">"MOI_Infection_Town_Code"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Looking through the variables, we realized that <em>Confirmed_Cases</em> have 2 rows that consist of count “2” instead of “1” like all the other rows. Thus, we duplicate these rows to the number of count (i.e.&nbsp;2) and change the count to “1”. The code will work for rows with number of count more than 2 as well. This column will then not be necessary for future steps.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for amending Confirmed_Cases column</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dengue_daily <span class="ot">&lt;-</span> dengue_daily <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Confirmed_Cases =</span> <span class="fu">list</span>(<span class="fu">rep</span>(<span class="dv">1</span>, Confirmed_Cases))) <span class="sc">%&gt;%</span>   </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Confirmed_Cases)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># to check if done correctly, uncomment below line code</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#dengue_daily %&gt;% filter(Confirmed_Cases != 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The relevant columns are then selected, and these include <em>Onset_Date</em>, <em>Gender</em>, <em>Age_Group</em>, <em>Residential_County_City</em>, <em>Residential_Town_District</em>, <em>X_coord</em>, <em>Y_coord</em>, <em>Imported_Case</em>, <em>Serotype</em>, <em>MOI_Residential_County_Code</em>, <em>MOI_Residential_Town_Code</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for columns selection</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dengue_daily <span class="ot">&lt;-</span> dengue_daily <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Onset_Date, Gender, Age_Group, Residential_County_City, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>           Residential_Town_District, X_coord, Y_coord, Imported_Case, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>           Serotype, MOI_Residential_County_Code, MOI_Residential_Town_Code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The data was also further scrutinized. The following amendments were made to make the dataset easier to reference and work with:</p>
<ol type="1">
<li>Translating <em>Residential_County_City</em>, <em>Imported_Case</em> and <em>Serotype</em> into English. This was done using <a href="https://translate.google.com.sg/">Google Translate</a>.</li>
<li>Creating a variable <em>Onset_Epiweek</em> from <em>Onset_Date</em>.</li>
<li>Changing 1 row consisting of <em>Gender</em> “U” to “M” instead. The row contains usable data in the other columns and does not need to be removed from the dataset. The gender is then changed to “M” for convenience. This should be noted when <em>Gender</em> is being studied, although it should not vary greatly due to the large dataset.</li>
<li>Padding <em>MOI_Residential_County_Code</em> with “0” to its right to make a 5 digit county code.</li>
<li>Binning ages 0-4 and amending the format of those in ages 5-9 (originally reflected as a date format). The age groups are then sorted in an ascending order.</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show Code for further preparation of data 1</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dengue_daily <span class="ot">&lt;-</span> dengue_daily <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Residential_County_City =</span> <span class="fu">recode</span>(Residential_County_City,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"屏東縣"</span> <span class="ot">=</span> <span class="st">"Pingtung County"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"宜蘭縣"</span> <span class="ot">=</span> <span class="st">"Yilan County"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"高雄市"</span> <span class="ot">=</span> <span class="st">"Kaohsiung City"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"桃園市"</span> <span class="ot">=</span> <span class="st">"Taoyuan City"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"新北市"</span> <span class="ot">=</span> <span class="st">"New Taipei City"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"台北市"</span> <span class="ot">=</span> <span class="st">"Taipei City"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"台南市"</span> <span class="ot">=</span> <span class="st">"Tainan City"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"新竹縣"</span> <span class="ot">=</span> <span class="st">"Hsinchu County"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"南投縣"</span> <span class="ot">=</span> <span class="st">"Nantou County"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"台中市"</span> <span class="ot">=</span> <span class="st">"Taichung City"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"新竹市"</span> <span class="ot">=</span> <span class="st">"Hsinchu City"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"雲林縣"</span> <span class="ot">=</span> <span class="st">"Yunlin County"</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"彰化縣"</span> <span class="ot">=</span> <span class="st">"Changhua County"</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"花蓮縣"</span> <span class="ot">=</span> <span class="st">"Hualien County"</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"台東縣"</span> <span class="ot">=</span> <span class="st">"Taitung County"</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"嘉義縣"</span> <span class="ot">=</span> <span class="st">"Chiayi County"</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"嘉義市"</span> <span class="ot">=</span> <span class="st">"Chiayi City"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"基隆市"</span> <span class="ot">=</span> <span class="st">"Keelung City"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"苗栗縣"</span> <span class="ot">=</span> <span class="st">"Miaoli County"</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"澎湖縣"</span> <span class="ot">=</span> <span class="st">"Penghu County"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"連江縣"</span> <span class="ot">=</span> <span class="st">"Lianjiang County"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"金門縣"</span> <span class="ot">=</span> <span class="st">"Kinmen County"</span>),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Onset_Epiweek =</span> <span class="fu">epiweek</span>(Onset_Date),</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">Gender =</span> <span class="fu">recode</span>(Gender, <span class="st">"U"</span> <span class="ot">=</span> <span class="st">"M"</span>),</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="at">Imported_Case =</span> <span class="fu">recode</span>(Imported_Case, <span class="st">"是"</span> <span class="ot">=</span> <span class="st">"Yes"</span>, </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"否"</span> <span class="ot">=</span> <span class="st">"No"</span>),</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="at">Serotype =</span> <span class="fu">recode</span>(Serotype, <span class="st">"第一型"</span> <span class="ot">=</span> <span class="st">"Type 1"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"第二型"</span> <span class="ot">=</span> <span class="st">"Type 2"</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"第三型"</span> <span class="ot">=</span> <span class="st">"Type 3"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"第四型"</span> <span class="ot">=</span> <span class="st">"Type 4"</span>),</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="at">MOI_Residential_County_Code =</span> </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>               <span class="fu">str_pad</span>(MOI_Residential_County_Code, <span class="at">width =</span> <span class="dv">5</span>, </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">side =</span> <span class="st">"right"</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="at">Age_Group =</span> <span class="fu">ifelse</span>(Age_Group <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>), <span class="st">"0-4"</span>, Age_Group),</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">Age_Group =</span> <span class="fu">factor</span>(Age_Group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0-4"</span>, <span class="st">"5-9"</span>, </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">sort</span>(<span class="fu">unique</span>(Age_Group[</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                                                      Age_Group <span class="sc">!=</span> <span class="st">"0-4"</span> <span class="sc">&amp;</span> Age_Group <span class="sc">!=</span> <span class="st">"5-9"</span>]</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>                                                      )))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for further preparation of data 2</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>weekly_cases <span class="ot">&lt;-</span> dengue_daily <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">floor_date</span>(Onset_Date, <span class="st">"week"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(week) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cases =</span> <span class="fu">n</span>())</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>wave1_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2014-05-11"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>wave1_end <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2015-01-25"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>wave2_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2015-05-24"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>wave2_end <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2016-02-14"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>wave3_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2023-05-07"</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>wave3_end <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-02-04"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>dengue_daily <span class="ot">&lt;-</span> dengue_daily <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    Onset_Date <span class="sc">&gt;=</span> wave1_start <span class="sc">&amp;</span> Onset_Date <span class="sc">&lt;=</span> wave1_end <span class="sc">~</span> <span class="st">"Wave 1"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    Onset_Date <span class="sc">&gt;=</span> wave2_start <span class="sc">&amp;</span> Onset_Date <span class="sc">&lt;=</span> wave2_end <span class="sc">~</span> <span class="st">"Wave 2"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    Onset_Date <span class="sc">&gt;=</span> wave3_start <span class="sc">&amp;</span> Onset_Date <span class="sc">&lt;=</span> wave3_end <span class="sc">~</span> <span class="st">"Wave 3"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> weekly_cases <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(week <span class="sc">&gt;=</span> wave1_start <span class="sc">&amp;</span> week <span class="sc">&lt;=</span> wave1_end)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> weekly_cases <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(week <span class="sc">&gt;=</span> wave2_start <span class="sc">&amp;</span> week <span class="sc">&lt;=</span> wave2_end)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> weekly_cases <span class="sc">%&gt;%</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(week <span class="sc">&gt;=</span> wave3_start <span class="sc">&amp;</span> week <span class="sc">&lt;=</span> wave3_end)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">month_day =</span> <span class="fu">format</span>(week, <span class="st">"%m-%d"</span>), <span class="at">Outbreak_Year =</span><span class="st">"2014"</span>, <span class="at">aligned_date =</span> <span class="fu">if_else</span>(<span class="fu">month</span>(week) <span class="sc">&lt;=</span> <span class="dv">3</span>,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"2024-"</span>, month_day)),</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"2023-"</span>, month_day)))</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">month_day =</span> <span class="fu">format</span>(week, <span class="st">"%m-%d"</span>), <span class="at">Outbreak_Year =</span><span class="st">"2015"</span>, <span class="at">aligned_date =</span> <span class="fu">if_else</span>(<span class="fu">month</span>(week) <span class="sc">&lt;=</span> <span class="dv">3</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"2024-"</span>, month_day)),</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"2023-"</span>, month_day)))</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">month_day =</span> <span class="fu">format</span>(week, <span class="st">"%m-%d"</span>), <span class="at">Outbreak_Year =</span><span class="st">"2023"</span>, <span class="at">aligned_date =</span> <span class="fu">if_else</span>(<span class="fu">month</span>(week) <span class="sc">&lt;=</span> <span class="dv">3</span>,</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"2024-"</span>, month_day)),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"2023-"</span>, month_day)))</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>all_waves <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(wave1, wave2, wave3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="week-based-curve-fitting" class="level1">
<h1>2. Week-based Curve Fitting</h1>
<p>Before starting on model comparison, we must first decide on the types of model we want to include in our comparison. Here is a quick summary of the curves that will be fitted.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for model summaries</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>table_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Poisson"</span>, <span class="st">"Negative Binomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"GAM"</span>, <span class="st">"Polynomial"</span>, <span class="st">"Lognormal"</span>, <span class="st">"Gamma"</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Best For</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Count data with equal mean/variance"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Overdispersed count data"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Early outbreak exponential growth"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Complex trends and multi-peak waves"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Epidemic waves (with right degree)"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cumulative or right-skewed data"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Skewed continuous outcome (e.g., duration)"</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Overdispersion =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Flexibility =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Moderate"</span>, <span class="st">"Low"</span>, <span class="st">"Very High"</span>, <span class="st">"High"</span>, <span class="st">"Moderate"</span>, <span class="st">"Moderate"</span>),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interpretability =</span> <span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"High"</span>, <span class="st">"High"</span>, <span class="st">"Moderate"</span>, <span class="st">"Low"</span>, <span class="st">"Low"</span>, <span class="st">"Low"</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Overfitting Risk</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"Low"</span>, <span class="st">"High"</span>, <span class="st">"High"</span>, <span class="st">"Medium"</span>, <span class="st">"Medium"</span>),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Remarks =</span> <span class="fu">c</span>(</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fails with overdispersion"</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Good for noisy data"</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fits only early phase"</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Flexible, needs tuning"</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prone to overfit with high degree"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Good for wave shapes"</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Good for cumulative modeling"</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>color_overdispersion <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"lightgreen"</span>, <span class="st">"tomato"</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>color_flexibility <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">case_when</span>(</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"Low"</span> <span class="sc">~</span> <span class="st">"#f4cccc"</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"Moderate"</span> <span class="sc">~</span> <span class="st">"#fce5cd"</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"High"</span> <span class="sc">~</span> <span class="st">"#d9ead3"</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"Very High"</span> <span class="sc">~</span> <span class="st">"#b6d7a8"</span>,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>color_interpretability <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">case_when</span>(</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"Low"</span> <span class="sc">~</span> <span class="st">"#f4cccc"</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"Moderate"</span> <span class="sc">~</span> <span class="st">"#fff2cc"</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"High"</span> <span class="sc">~</span> <span class="st">"#b6d7a8"</span>,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>color_overfitting <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">case_when</span>(</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"Low"</span> <span class="sc">~</span> <span class="st">"#b6d7a8"</span>,</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"Medium"</span> <span class="sc">~</span> <span class="st">"#ffe599"</span>,</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">==</span> <span class="st">"High"</span> <span class="sc">~</span> <span class="st">"#f4cccc"</span>,</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>table_data <span class="sc">%&gt;%</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Comparison of Curve Fitting Models"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(Overdispersion), <span class="at">fn =</span> color_overdispersion) <span class="sc">%&gt;%</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(Flexibility), <span class="at">fn =</span> color_flexibility) <span class="sc">%&gt;%</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(Interpretability), <span class="at">fn =</span> color_interpretability) <span class="sc">%&gt;%</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Overfitting Risk</span><span class="st">`</span>), <span class="at">fn =</span> color_overfitting)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="hneftiypow" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hneftiypow table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hneftiypow thead, #hneftiypow tbody, #hneftiypow tfoot, #hneftiypow tr, #hneftiypow td, #hneftiypow th {
  border-style: none;
}

#hneftiypow p {
  margin: 0;
  padding: 0;
}

#hneftiypow .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hneftiypow .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hneftiypow .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hneftiypow .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hneftiypow .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hneftiypow .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hneftiypow .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hneftiypow .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hneftiypow .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hneftiypow .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hneftiypow .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hneftiypow .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hneftiypow .gt_spanner_row {
  border-bottom-style: hidden;
}

#hneftiypow .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hneftiypow .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hneftiypow .gt_from_md > :first-child {
  margin-top: 0;
}

#hneftiypow .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hneftiypow .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hneftiypow .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hneftiypow .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hneftiypow .gt_row_group_first td {
  border-top-width: 2px;
}

#hneftiypow .gt_row_group_first th {
  border-top-width: 2px;
}

#hneftiypow .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hneftiypow .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hneftiypow .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hneftiypow .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hneftiypow .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hneftiypow .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hneftiypow .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hneftiypow .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hneftiypow .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hneftiypow .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hneftiypow .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hneftiypow .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hneftiypow .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hneftiypow .gt_left {
  text-align: left;
}

#hneftiypow .gt_center {
  text-align: center;
}

#hneftiypow .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hneftiypow .gt_font_normal {
  font-weight: normal;
}

#hneftiypow .gt_font_bold {
  font-weight: bold;
}

#hneftiypow .gt_font_italic {
  font-style: italic;
}

#hneftiypow .gt_super {
  font-size: 65%;
}

#hneftiypow .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hneftiypow .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hneftiypow .gt_indent_1 {
  text-indent: 5px;
}

#hneftiypow .gt_indent_2 {
  text-indent: 10px;
}

#hneftiypow .gt_indent_3 {
  text-indent: 15px;
}

#hneftiypow .gt_indent_4 {
  text-indent: 20px;
}

#hneftiypow .gt_indent_5 {
  text-indent: 25px;
}

#hneftiypow .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hneftiypow div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border">Comparison of Curve Fitting Models</th>
</tr>
<tr class="gt_col_headings even">
<th id="Model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Model</th>
<th id="Best-For" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Best For</th>
<th id="Overdispersion" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Overdispersion</th>
<th id="Flexibility" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Flexibility</th>
<th id="Interpretability" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Interpretability</th>
<th id="Overfitting-Risk" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Overfitting Risk</th>
<th id="Remarks" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Remarks</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Model">Poisson</td>
<td class="gt_row gt_left" headers="Best For">Count data with equal mean/variance</td>
<td class="gt_row gt_left" headers="Overdispersion" style="background-color: #FF6347; color: #FFFFFF">No</td>
<td class="gt_row gt_left" headers="Flexibility" style="background-color: #F4CCCC; color: #000000">Low</td>
<td class="gt_row gt_left" headers="Interpretability" style="background-color: #B6D7A8; color: #000000">High</td>
<td class="gt_row gt_left" headers="Overfitting Risk" style="background-color: #B6D7A8; color: #000000">Low</td>
<td class="gt_row gt_left" headers="Remarks">Fails with overdispersion</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Model">Negative Binomial</td>
<td class="gt_row gt_left" headers="Best For">Overdispersed count data</td>
<td class="gt_row gt_left" headers="Overdispersion" style="background-color: #90EE90; color: #000000">Yes</td>
<td class="gt_row gt_left" headers="Flexibility" style="background-color: #FCE5CD; color: #000000">Moderate</td>
<td class="gt_row gt_left" headers="Interpretability" style="background-color: #B6D7A8; color: #000000">High</td>
<td class="gt_row gt_left" headers="Overfitting Risk" style="background-color: #FFE599; color: #000000">Medium</td>
<td class="gt_row gt_left" headers="Remarks">Good for noisy data</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Model">Exponential</td>
<td class="gt_row gt_left" headers="Best For">Early outbreak exponential growth</td>
<td class="gt_row gt_left" headers="Overdispersion" style="background-color: #FF6347; color: #FFFFFF">No</td>
<td class="gt_row gt_left" headers="Flexibility" style="background-color: #F4CCCC; color: #000000">Low</td>
<td class="gt_row gt_left" headers="Interpretability" style="background-color: #B6D7A8; color: #000000">High</td>
<td class="gt_row gt_left" headers="Overfitting Risk" style="background-color: #B6D7A8; color: #000000">Low</td>
<td class="gt_row gt_left" headers="Remarks">Fits only early phase</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Model">GAM</td>
<td class="gt_row gt_left" headers="Best For">Complex trends and multi-peak waves</td>
<td class="gt_row gt_left" headers="Overdispersion" style="background-color: #90EE90; color: #000000">Yes</td>
<td class="gt_row gt_left" headers="Flexibility" style="background-color: #B6D7A8; color: #000000">Very High</td>
<td class="gt_row gt_left" headers="Interpretability" style="background-color: #FFF2CC; color: #000000">Moderate</td>
<td class="gt_row gt_left" headers="Overfitting Risk" style="background-color: #F4CCCC; color: #000000">High</td>
<td class="gt_row gt_left" headers="Remarks">Flexible, needs tuning</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Model">Polynomial</td>
<td class="gt_row gt_left" headers="Best For">Epidemic waves (with right degree)</td>
<td class="gt_row gt_left" headers="Overdispersion" style="background-color: #FF6347; color: #FFFFFF">No</td>
<td class="gt_row gt_left" headers="Flexibility" style="background-color: #D9EAD3; color: #000000">High</td>
<td class="gt_row gt_left" headers="Interpretability" style="background-color: #F4CCCC; color: #000000">Low</td>
<td class="gt_row gt_left" headers="Overfitting Risk" style="background-color: #F4CCCC; color: #000000">High</td>
<td class="gt_row gt_left" headers="Remarks">Prone to overfit with high degree</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Model">Lognormal</td>
<td class="gt_row gt_left" headers="Best For">Cumulative or right-skewed data</td>
<td class="gt_row gt_left" headers="Overdispersion" style="background-color: #90EE90; color: #000000">Yes</td>
<td class="gt_row gt_left" headers="Flexibility" style="background-color: #FCE5CD; color: #000000">Moderate</td>
<td class="gt_row gt_left" headers="Interpretability" style="background-color: #F4CCCC; color: #000000">Low</td>
<td class="gt_row gt_left" headers="Overfitting Risk" style="background-color: #FFE599; color: #000000">Medium</td>
<td class="gt_row gt_left" headers="Remarks">Good for wave shapes</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Model">Gamma</td>
<td class="gt_row gt_left" headers="Best For">Skewed continuous outcome (e.g., duration)</td>
<td class="gt_row gt_left" headers="Overdispersion" style="background-color: #90EE90; color: #000000">Yes</td>
<td class="gt_row gt_left" headers="Flexibility" style="background-color: #FCE5CD; color: #000000">Moderate</td>
<td class="gt_row gt_left" headers="Interpretability" style="background-color: #F4CCCC; color: #000000">Low</td>
<td class="gt_row gt_left" headers="Overfitting Risk" style="background-color: #FFE599; color: #000000">Medium</td>
<td class="gt_row gt_left" headers="Remarks">Good for cumulative modeling</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="outbreak-year-2014" class="level2">
<h2 class="anchored" data-anchor-id="outbreak-year-2014">2.1. Outbreak Year 2014</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code to obtain Week Index</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span>   </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(week) <span class="sc">%&gt;%</span>   </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week_index =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="model-comparison" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison">2.1.1. Model Comparison</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code for different models</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson model</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>poisson_model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> wave1)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative Binomial model</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>nb_model1 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(cases <span class="sc">~</span> week_index, <span class="at">data =</span> wave1)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential model (linear model on log scale)</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>exp_model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">data =</span> wave1)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the GAM model </span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>gam_model1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(cases <span class="sc">~</span> <span class="fu">s</span>(week_index), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave1)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit 2nd-degree polynomial Poisson regression</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>poly_model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(week_index, <span class="dv">2</span>), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave1)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-Normal (fit on log-transformed cases + 1 to avoid log(0))</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>lognormal_model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">data =</span> wave1)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Gamma</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>gamma_model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> wave1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for fitted curves</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparation</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_poisson1 =</span> <span class="fu">predict</span>(poisson_model1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_nb1 =</span> <span class="fu">predict</span>(nb_model1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_exp1 =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(exp_model1)),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_gam1 =</span> <span class="fu">predict</span>(gam_model1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_poly1 =</span> <span class="fu">predict</span>(poly_model1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_lognormal1 =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(lognormal_model1)),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_gamma1     =</span> <span class="fu">predict</span>(gamma_model1, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wave1, <span class="fu">aes</span>(<span class="at">x =</span> week_index)) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cases), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_poisson1, <span class="at">color =</span> <span class="st">"Poisson"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_nb1, <span class="at">color =</span> <span class="st">"Negative Binomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_exp1, <span class="at">color =</span> <span class="st">"Exponential"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_gam1, <span class="at">color =</span> <span class="st">"GAM"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_poly1, <span class="at">color =</span> <span class="st">"Polynomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_lognormal1, <span class="at">color =</span> <span class="st">"Log-Normal"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_gamma1, <span class="at">color =</span> <span class="st">"Gamma"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code for fitted curves</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Comparison on 2014 Outbreak"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black = Actual, Lines = Model Fits"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>, <span class="at">y =</span> <span class="st">"Number of Cases"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p>To ensure a better fit for the Polynomial Model, we run the model through different degrees of freedom and get the AIC of each plot, before choosing the best degree that will give us reasonably good AIC results without excessively increasing the degree of freedom.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code to check AIC of Polynomial Model by varying degree of freedom</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>degrees1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>aic_values1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(degrees1))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>models1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> degrees1) {</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(week_index, i), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave1)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  models1[[i]] <span class="ot">&lt;-</span> model1</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  aic_values1[i] <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model1)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>aic_df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Degree1 =</span> degrees1,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC1 =</span> aic_values1</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(aic_df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Degree1       AIC1
1        1 18323.2559
2        2  2259.2223
3        3   750.8355
4        4   617.9736
5        5   511.6079
6        6   458.4039
7        7   460.3838
8        8   461.8459
9        9   442.1706
10      10   442.1970</code></pre>
</div>
</div>
<p>The degree of freedom is then changed before plotting the Polynomial Model again. We should now see that it is a better fit to the dataset.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code on replotting Polynomial Model</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing to fit 3rd-degree polynomial Poisson regression</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>poly_model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(week_index, <span class="dv">6</span>), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave1)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_poly1 =</span> <span class="fu">predict</span>(poly_model1, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-plotting the graph</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wave1, <span class="fu">aes</span>(<span class="at">x =</span> week_index)) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cases), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_poisson1, <span class="at">color =</span> <span class="st">"Poisson"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_nb1, <span class="at">color =</span> <span class="st">"Negative Binomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_exp1, <span class="at">color =</span> <span class="st">"Exponential"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_gam1, <span class="at">color =</span> <span class="st">"GAM"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_poly1, <span class="at">color =</span> <span class="st">"Polynomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_lognormal1, <span class="at">color =</span> <span class="st">"Log-Normal"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_gamma1, <span class="at">color =</span> <span class="st">"Gamma"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Comparison on 2014 Outbreak"</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black = Actual, Lines = Model Fits"</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>, <span class="at">y =</span> <span class="st">"Number of Cases"</span>,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="akaike-information-criterion-aic" class="level4">
<h4 class="anchored" data-anchor-id="akaike-information-criterion-aic">2.1.1.1. Akaike Information Criterion (AIC)</h4>
<p>We then compare the AIC values of all the models.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for all models’ AIC values</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(poisson_model1, nb_model1, exp_model1, poly_model1, gam_model1, lognormal_model1, gamma_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       df        AIC
poisson_model1   2.000000 18323.2559
nb_model1        3.000000   517.2099
exp_model1       3.000000   150.6526
poly_model1      7.000000   458.4039
gam_model1       9.740789   439.9684
lognormal_model1 3.000000   150.6526
gamma_model1     3.000000   517.6125</code></pre>
</div>
</div>
</section>
<section id="residuals" class="level4">
<h4 class="anchored" data-anchor-id="residuals">2.1.1.2. Residuals</h4>
<p>We also look at the residuals for the different models to check on the fitting of the different models.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting all models’ residuals</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining residuals</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_poisson =</span> <span class="fu">residuals</span>(poisson_model1, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_nb =</span> <span class="fu">residuals</span>(nb_model1, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_exp =</span> <span class="fu">residuals</span>(exp_model1, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_poly =</span> <span class="fu">residuals</span>(poly_model1, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_gam =</span> <span class="fu">residuals</span>(gam_model1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_lognormal =</span> <span class="fu">residuals</span>(lognormal_model1, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_gamma =</span> <span class="fu">residuals</span>(gamma_model1, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting to long format</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>resid_long1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span>   </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(week_index, resid_poisson, resid_nb, resid_exp, resid_poly, resid_gam, resid_lognormal, resid_gamma) <span class="sc">%&gt;%</span>   </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(     </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"resid_"</span>),     </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"model"</span>,     </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"residual"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">recode</span>(model,                         </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_poisson =</span> <span class="st">"Poisson"</span>,                         </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_nb =</span> <span class="st">"Negative Binomial"</span>,             </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_exp =</span> <span class="st">"Exponential"</span>,                        </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_poly =</span> <span class="st">"Polynomial"</span>,                         </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_gam =</span> <span class="st">"GAM"</span>,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_lognormal =</span> <span class="st">"Lognormal"</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_gamma =</span> <span class="st">"Gamma"</span>)) </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>resid_long1<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(resid_long1<span class="sc">$</span>model,                       </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Poisson"</span>, <span class="st">"Negative Binomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"Polynomial"</span>, <span class="st">"GAM"</span>, <span class="st">"Lognormal"</span>, <span class="st">"Gamma"</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting residuals</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resid_long1, <span class="fu">aes</span>(<span class="at">x =</span> week_index, <span class="at">y =</span> residual, <span class="at">color =</span> model)) <span class="sc">+</span>   <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> model, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span>   </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(     </span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Residuals for All Models"</span>,     </span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>,     </span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuals"</span>) <span class="sc">+</span>   </span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="root-mean-squared-error-rmse" class="level4">
<h4 class="anchored" data-anchor-id="root-mean-squared-error-rmse">2.1.1.3. Root Mean Squared Error (RMSE)</h4>
<p>The Root Mean Squared Error (RMSE) is also calculated to know the variation of the fitted curves from the actual data.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for all models’ RMSE values</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>rmse_summary1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span>    </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(          </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Poisson =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_poisson<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Negative Binomial</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_nb<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exponential =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_exp<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Polynomial =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_poly<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">GAM =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_gam<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lognormal =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_lognormal<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gamma =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_gamma<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span>      </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Model"</span>, <span class="at">values_to =</span> <span class="st">"RMSE"</span>)  </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rmse_summary1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Model, RMSE), <span class="at">y =</span> RMSE, <span class="at">fill =</span> Model)) <span class="sc">+</span>      </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>      </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RMSE, <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span>      </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(          </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"RMSE Comparison Across Models"</span>,  </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Lower RMSE indicates better fit"</span>, </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>, <span class="at">y =</span> <span class="st">"RMSE"</span>) <span class="sc">+</span>      </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cumulative-model-comparison" class="level3">
<h3 class="anchored" data-anchor-id="cumulative-model-comparison">2.1.2. Cumulative Model Comparison</h3>
<p>Cumulative Model Comparisons are also done for the same 7 models.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting Cumulative Models</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparation</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_cases       =</span> <span class="fu">cumsum</span>(cases),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_poisson     =</span> <span class="fu">cumsum</span>(fitted_poisson1),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_nb          =</span> <span class="fu">cumsum</span>(fitted_nb1),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_exp         =</span> <span class="fu">cumsum</span>(fitted_exp1),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_gam         =</span> <span class="fu">cumsum</span>(fitted_gam1),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_poly        =</span> <span class="fu">cumsum</span>(fitted_poly1),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_lognormal    =</span> <span class="fu">cumsum</span>(fitted_lognormal1),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_gamma        =</span> <span class="fu">cumsum</span>(fitted_gamma1)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wave1, <span class="fu">aes</span>(<span class="at">x =</span> week_index)) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_cases), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_poisson, <span class="at">color =</span> <span class="st">"Poisson"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_nb, <span class="at">color =</span> <span class="st">"Negative Binomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_exp, <span class="at">color =</span> <span class="st">"Exponential"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_gam, <span class="at">color =</span> <span class="st">"GAM"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_poly, <span class="at">color =</span> <span class="st">"Polynomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_lognormal, <span class="at">color =</span> <span class="st">"Log-Normal"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_gamma, <span class="at">color =</span> <span class="st">"Gamma"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cumulative Cases vs Model Fits"</span>,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black dots = Actual || Lines = Fitted Cumulative Cases"</span>,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>,</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Number of Cases"</span>,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="residuals-1" class="level4">
<h4 class="anchored" data-anchor-id="residuals-1">2.1.2.1. Residuals</h4>
<p>Residuals of these models are also plotted.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting Cumulative Models’ residuals</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepatation</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_poisson =</span> cumulative_cases <span class="sc">-</span> cumulative_poisson,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_nb      =</span> cumulative_cases <span class="sc">-</span> cumulative_nb,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_exp     =</span> cumulative_cases <span class="sc">-</span> cumulative_exp,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_poly    =</span> cumulative_cases <span class="sc">-</span> cumulative_poly,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_gam     =</span> cumulative_cases <span class="sc">-</span> cumulative_gam,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_lognormal     =</span> cumulative_cases <span class="sc">-</span> cumulative_lognormal,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_gamma   =</span> cumulative_cases <span class="sc">-</span> cumulative_gamma</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting to long format</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>resid_cum_long1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(week_index, resid_cum_poisson, resid_cum_nb, resid_cum_exp, resid_cum_poly, resid_cum_gam, resid_cum_lognormal, resid_cum_gamma) <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"resid_cum"</span>),</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"model"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"cumulative_residual"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">recode</span>(model,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_poisson =</span> <span class="st">"Poisson"</span>,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_nb =</span> <span class="st">"Negative Binomial"</span>,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_exp =</span> <span class="st">"Exponential"</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_poly =</span> <span class="st">"Polynomial"</span>,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_gam =</span> <span class="st">"GAM"</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_lognormal =</span> <span class="st">"Lognormal"</span>,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_gamma =</span> <span class="st">"Gamma"</span>))</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resid_cum_long1, <span class="fu">aes</span>(<span class="at">x =</span> week_index, <span class="at">y =</span> cumulative_residual, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> model, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cumulative Residuals by Model"</span>,</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>,</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Residual (Actual - Fitted)"</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rmse" class="level4">
<h4 class="anchored" data-anchor-id="rmse">2.1.2.2. RMSE</h4>
<p>RMSE for these cumulative models are also calculated to compare them against actual values.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for all Cumulative Models’ RMSE values</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparation</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>rmse_cum_poisson1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave1<span class="sc">$</span>resid_cum_poisson<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>rmse_cum_nb1      <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave1<span class="sc">$</span>resid_cum_nb<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>rmse_cum_exp1     <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave1<span class="sc">$</span>resid_cum_exp<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>rmse_cum_gam1     <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave1<span class="sc">$</span>resid_cum_gam<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>rmse_cum_poly1    <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave1<span class="sc">$</span>resid_cum_poly<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>rmse_cum_lognormal1    <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave1<span class="sc">$</span>resid_cum_lognormal<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>rmse_cum_gamma1   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave1<span class="sc">$</span>resid_cum_gamma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Put in a table</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>rmse_table1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Poisson"</span>, <span class="st">"Negative Binomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"GAM"</span>, <span class="st">"Polynomial"</span>, <span class="st">"Lognormal"</span>, <span class="st">"Gamma"</span>),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE  =</span> <span class="fu">c</span>(rmse_cum_poisson1, rmse_cum_nb1, rmse_cum_exp1, rmse_cum_gam1, rmse_cum_poly1, rmse_cum_lognormal1, rmse_cum_gamma1)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rmse_table1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Model, RMSE), <span class="at">y =</span> RMSE, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RMSE, <span class="dv">1</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"RMSE of Cumulative Cases by Model"</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">subtitle =</span> <span class="st">"Lower RMSE indicates better fit"</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"RMSE"</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The same are also done for Outbreak Year 2015 and 2023.</p>
</section>
</section>
</section>
<section id="outbreak-year-2015" class="level2">
<h2 class="anchored" data-anchor-id="outbreak-year-2015">2.2. Outbreak Year 2015</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code for 2015 Outbreak week index</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span>   </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(week) <span class="sc">%&gt;%</span>   </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week_index =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="model-comparison-1" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison-1">2.2.1. Model Comparison</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code for AIC values of Polynomial Model</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>degrees2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>aic_values2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(degrees2))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>models2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> degrees2) {</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(week_index, i), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave2)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  models2[[i]] <span class="ot">&lt;-</span> model2</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  aic_values2[i] <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model2)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>aic_df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Degree2 =</span> degrees2,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC2 =</span> aic_values2</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for fitting curves</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>poisson_model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> wave2)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>nb_model2 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(cases <span class="sc">~</span> week_index, <span class="at">data =</span> wave2)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>exp_model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">data =</span> wave2)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>gam_model2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(cases <span class="sc">~</span> <span class="fu">s</span>(week_index), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave2)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>poly_model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(week_index, <span class="dv">12</span>), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave2)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>lognormal_model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">data =</span> wave2)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>gamma_model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> wave2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting models for 2015 Outbreak</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparation</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_poisson2 =</span> <span class="fu">predict</span>(poisson_model2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_nb2 =</span> <span class="fu">predict</span>(nb_model2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_exp2 =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(exp_model2)),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_gam2 =</span> <span class="fu">predict</span>(gam_model2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_poly2 =</span> <span class="fu">predict</span>(poly_model2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_lognormal2 =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(lognormal_model2)),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_gamma2     =</span> <span class="fu">predict</span>(gamma_model2, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wave2, <span class="fu">aes</span>(<span class="at">x =</span> week_index)) <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cases), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_poisson2, <span class="at">color =</span> <span class="st">"Poisson"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_nb2, <span class="at">color =</span> <span class="st">"Negative Binomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_exp2, <span class="at">color =</span> <span class="st">"Exponential"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_gam2, <span class="at">color =</span> <span class="st">"GAM"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_poly2, <span class="at">color =</span> <span class="st">"Polynomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_lognormal2, <span class="at">color =</span> <span class="st">"Log-Normal"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_gamma2, <span class="at">color =</span> <span class="st">"Gamma"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Comparison on 2015 Outbreak"</span>,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black = Actual, Lines = Model Fits"</span>,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>, <span class="at">y =</span> <span class="st">"Number of Cases"</span>,</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="aic" class="level4">
<h4 class="anchored" data-anchor-id="aic">2.2.1.1. AIC</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for AIC values</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(poisson_model2, nb_model2, exp_model2, poly_model2, gam_model2, lognormal_model2, gamma_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                        df        AIC
poisson_model2    2.000000 58699.5229
nb_model2         3.000000   609.6094
exp_model2        3.000000   174.9942
poly_model2      13.000000   666.8310
gam_model2        9.926241   642.3945
lognormal_model2  3.000000   174.9942
gamma_model2      3.000000   611.1210</code></pre>
</div>
</div>
</section>
<section id="residuals-2" class="level4">
<h4 class="anchored" data-anchor-id="residuals-2">2.2.1.2. Residuals</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting residuals</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining residuals</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_poisson =</span> <span class="fu">residuals</span>(poisson_model2, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_nb =</span> <span class="fu">residuals</span>(nb_model2, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_exp =</span> <span class="fu">residuals</span>(exp_model2, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_poly =</span> <span class="fu">residuals</span>(poly_model2, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_gam =</span> <span class="fu">residuals</span>(gam_model2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_lognormal =</span> <span class="fu">residuals</span>(lognormal_model2, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_gamma =</span> <span class="fu">residuals</span>(gamma_model2, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting to long format</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>resid_long2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span>   </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(week_index, resid_poisson, resid_nb, resid_exp, resid_poly, resid_gam, resid_lognormal, resid_gamma) <span class="sc">%&gt;%</span>   </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(     </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"resid_"</span>),     </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"model"</span>,     </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"residual"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">recode</span>(model,                         </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_poisson =</span> <span class="st">"Poisson"</span>,                         </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_nb =</span> <span class="st">"Negative Binomial"</span>,             </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_exp =</span> <span class="st">"Exponential"</span>,                        </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_poly =</span> <span class="st">"Polynomial"</span>,                         </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_gam =</span> <span class="st">"GAM"</span>,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_lognormal =</span> <span class="st">"Lognormal"</span>,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_gamma =</span> <span class="st">"Gamma"</span>)) </span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>resid_long2<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(resid_long2<span class="sc">$</span>model,                       </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Poisson"</span>, <span class="st">"Negative Binomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"Polynomial"</span>, <span class="st">"GAM"</span>, <span class="st">"Lognormal"</span>, <span class="st">"Gamma"</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting residuals</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resid_long2, <span class="fu">aes</span>(<span class="at">x =</span> week_index, <span class="at">y =</span> residual, <span class="at">color =</span> model)) <span class="sc">+</span>   <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> model, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span>   </span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(     </span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Residuals for All Models"</span>,     </span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>,     </span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuals"</span>) <span class="sc">+</span>   </span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rmse-1" class="level4">
<h4 class="anchored" data-anchor-id="rmse-1">2.2.1.3. RMSE</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for RMSE values</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>rmse_summary2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span>    </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(          </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Poisson =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_poisson<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Negative Binomial</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_nb<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exponential =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_exp<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Polynomial =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_poly<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">GAM =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_gam<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lognormal =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_lognormal<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gamma =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_gamma<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span>      </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Model"</span>, <span class="at">values_to =</span> <span class="st">"RMSE"</span>)  </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rmse_summary2, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Model, RMSE), <span class="at">y =</span> RMSE, <span class="at">fill =</span> Model)) <span class="sc">+</span>      </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>      </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RMSE, <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span>      </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(          </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"RMSE Comparison Across Models"</span>, </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Lower RMSE indicates better fit"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>, <span class="at">y =</span> <span class="st">"RMSE"</span>) <span class="sc">+</span>      </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cumulative-model-comparison-1" class="level3">
<h3 class="anchored" data-anchor-id="cumulative-model-comparison-1">2.2.2. Cumulative Model Comparison</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting Cumulative Models</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparation</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_cases       =</span> <span class="fu">cumsum</span>(cases),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_poisson     =</span> <span class="fu">cumsum</span>(fitted_poisson2),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_nb          =</span> <span class="fu">cumsum</span>(fitted_nb2),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_exp         =</span> <span class="fu">cumsum</span>(fitted_exp2),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_gam         =</span> <span class="fu">cumsum</span>(fitted_gam2),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_poly        =</span> <span class="fu">cumsum</span>(fitted_poly2),</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_lognormal    =</span> <span class="fu">cumsum</span>(fitted_lognormal2),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_gamma        =</span> <span class="fu">cumsum</span>(fitted_gamma2)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wave2, <span class="fu">aes</span>(<span class="at">x =</span> week_index)) <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_cases), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_poisson, <span class="at">color =</span> <span class="st">"Poisson"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_nb, <span class="at">color =</span> <span class="st">"Negative Binomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_exp, <span class="at">color =</span> <span class="st">"Exponential"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_gam, <span class="at">color =</span> <span class="st">"GAM"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_poly, <span class="at">color =</span> <span class="st">"Polynomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_lognormal, <span class="at">color =</span> <span class="st">"Lognormal"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_gamma, <span class="at">color =</span> <span class="st">"Gamma"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cumulative Cases vs Model Fits"</span>,</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black dots = Actual || Lines = Fitted Cumulative Cases"</span>,</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>,</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Number of Cases"</span>,</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="residuals-3" class="level4">
<h4 class="anchored" data-anchor-id="residuals-3">2.2.2.1. Residuals</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting Cumulative Models’ residuals</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepatation</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_poisson =</span> cumulative_cases <span class="sc">-</span> cumulative_poisson,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_nb      =</span> cumulative_cases <span class="sc">-</span> cumulative_nb,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_exp     =</span> cumulative_cases <span class="sc">-</span> cumulative_exp,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_poly    =</span> cumulative_cases <span class="sc">-</span> cumulative_poly,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_gam     =</span> cumulative_cases <span class="sc">-</span> cumulative_gam,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_lognormal     =</span> cumulative_cases <span class="sc">-</span> cumulative_lognormal,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_gamma   =</span> cumulative_cases <span class="sc">-</span> cumulative_gamma</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting to long format</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>resid_cum_long2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(week_index, resid_cum_poisson, resid_cum_nb, resid_cum_exp, resid_cum_poly, resid_cum_gam, resid_cum_lognormal, resid_cum_gamma) <span class="sc">%&gt;%</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"resid_cum"</span>),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"model"</span>,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"cumulative_residual"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">recode</span>(model,</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_poisson =</span> <span class="st">"Poisson"</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_nb =</span> <span class="st">"Negative Binomial"</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_exp =</span> <span class="st">"Exponential"</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_poly =</span> <span class="st">"Polynomial"</span>,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_gam =</span> <span class="st">"GAM"</span>,</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_lognormal =</span> <span class="st">"Lognormal"</span>,</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_gamma =</span> <span class="st">"Gamma"</span>))</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resid_cum_long2, <span class="fu">aes</span>(<span class="at">x =</span> week_index, <span class="at">y =</span> cumulative_residual, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> model, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cumulative Residuals by Model"</span>,</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>,</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Residual (Actual - Fitted)"</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rmse-2" class="level4">
<h4 class="anchored" data-anchor-id="rmse-2">2.2.2.2. RMSE</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for Cumulative Models’ RMSE values</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparation</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>rmse_cum_poisson2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave2<span class="sc">$</span>resid_cum_poisson<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>rmse_cum_nb2      <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave2<span class="sc">$</span>resid_cum_nb<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>rmse_cum_exp2     <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave2<span class="sc">$</span>resid_cum_exp<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>rmse_cum_gam2     <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave2<span class="sc">$</span>resid_cum_gam<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>rmse_cum_poly2    <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave2<span class="sc">$</span>resid_cum_poly<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>rmse_cum_lognormal2    <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave2<span class="sc">$</span>resid_cum_lognormal<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>rmse_cum_gamma2   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave2<span class="sc">$</span>resid_cum_gamma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Put in a table</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>rmse_table2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Poisson"</span>, <span class="st">"Negative Binomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"GAM"</span>, <span class="st">"Polynomial"</span>, <span class="st">"Lognormal"</span>, <span class="st">"Gamma"</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE  =</span> <span class="fu">c</span>(rmse_cum_poisson2, rmse_cum_nb2, rmse_cum_exp2, rmse_cum_gam2, rmse_cum_poly2, rmse_cum_lognormal2, rmse_cum_gamma2)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rmse_table2, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Model, RMSE), <span class="at">y =</span> RMSE, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RMSE, <span class="dv">1</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"RMSE of Cumulative Cases by Model"</span>,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Lower RMSE indicates better fit"</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"RMSE"</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="outbreak-year-2023" class="level2">
<h2 class="anchored" data-anchor-id="outbreak-year-2023">2.3. Outbreak Year 2023</h2>
<section id="model-comparison-2" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison-2">2.3.1. Model Comparison</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code for 2023 Outbreak week index</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span>   </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(week) <span class="sc">%&gt;%</span>   </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week_index =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for AIC values of Polynomial Model</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>degrees3 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>aic_values3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(degrees3))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>models3 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> degrees3) {</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(week_index, i), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave3)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  models3[[i]] <span class="ot">&lt;-</span> model3</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  aic_values3[i] <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model3)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>aic_df3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Degree3 =</span> degrees3,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC3 =</span> aic_values3</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for fitting curves</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>poisson_model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> wave3)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>nb_model3 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(cases <span class="sc">~</span> week_index, <span class="at">data =</span> wave3)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>exp_model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">data =</span> wave3)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>gam_model3 <span class="ot">&lt;-</span> <span class="fu">gam</span>(cases <span class="sc">~</span> <span class="fu">s</span>(week_index), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave3)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>poly_model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(week_index, <span class="dv">9</span>), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave3)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>lognormal_model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">data =</span> wave3)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>gamma_model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> week_index, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> wave3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting models for 2023 Outbreak</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparation</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_poisson3 =</span> <span class="fu">predict</span>(poisson_model3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_nb3 =</span> <span class="fu">predict</span>(nb_model3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_exp3 =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(exp_model3)),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_gam3 =</span> <span class="fu">predict</span>(gam_model3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_poly3 =</span> <span class="fu">predict</span>(poly_model3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_lognormal3 =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(lognormal_model2)),</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_gamma3     =</span> <span class="fu">predict</span>(gamma_model2, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wave3, <span class="fu">aes</span>(<span class="at">x =</span> week_index)) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cases), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_poisson3, <span class="at">color =</span> <span class="st">"Poisson"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_nb3, <span class="at">color =</span> <span class="st">"Negative Binomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_exp3, <span class="at">color =</span> <span class="st">"Exponential"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_gam3, <span class="at">color =</span> <span class="st">"GAM"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_poly3, <span class="at">color =</span> <span class="st">"Polynomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_lognormal3, <span class="at">color =</span> <span class="st">"Log-Normal"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted_gamma3, <span class="at">color =</span> <span class="st">"Gamma"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Comparison on 2023 Outbreak"</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black = Actual, Lines = Model Fits"</span>,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>, <span class="at">y =</span> <span class="st">"Number of Cases"</span>,</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="aic-1" class="level4">
<h4 class="anchored" data-anchor-id="aic-1">2.3.1.1. AIC</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for AIC values</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(poisson_model3, nb_model3, exp_model3, poly_model3, gam_model3, lognormal_model3, gamma_model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                        df        AIC
poisson_model3    2.000000 35694.9045
nb_model3         3.000000   576.5524
exp_model3        3.000000   169.7138
poly_model3      10.000000   648.7884
gam_model3        9.913975   582.5120
lognormal_model3  3.000000   169.7138
gamma_model3      3.000000   577.6858</code></pre>
</div>
</div>
</section>
<section id="residuals-4" class="level4">
<h4 class="anchored" data-anchor-id="residuals-4">2.3.1.2. Residuals</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting residuals</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining residuals</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_poisson =</span> <span class="fu">residuals</span>(poisson_model3, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_nb =</span> <span class="fu">residuals</span>(nb_model3, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_exp =</span> <span class="fu">residuals</span>(exp_model3, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_poly =</span> <span class="fu">residuals</span>(poly_model3, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_gam =</span> <span class="fu">residuals</span>(gam_model3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_lognormal =</span> <span class="fu">residuals</span>(lognormal_model3, <span class="at">type =</span> <span class="st">"response"</span>),     </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_gamma =</span> <span class="fu">residuals</span>(gamma_model3, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting to long format</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>resid_long3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span>   </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(week_index, resid_poisson, resid_nb, resid_exp, resid_poly, resid_gam, resid_lognormal, resid_gamma) <span class="sc">%&gt;%</span>   </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(     </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"resid_"</span>),     </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"model"</span>,     </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"residual"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">recode</span>(model,                         </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_poisson =</span> <span class="st">"Poisson"</span>,                         </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_nb =</span> <span class="st">"Negative Binomial"</span>,             </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_exp =</span> <span class="st">"Exponential"</span>,                        </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_poly =</span> <span class="st">"Polynomial"</span>,                         </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_gam =</span> <span class="st">"GAM"</span>,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_lognormal =</span> <span class="st">"Lognormal"</span>,</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_gamma =</span> <span class="st">"Gamma"</span>)) </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>resid_long3<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(resid_long3<span class="sc">$</span>model,                       </span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Poisson"</span>, <span class="st">"Negative Binomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"Polynomial"</span>, <span class="st">"GAM"</span>, <span class="st">"Lognormal"</span>, <span class="st">"Gamma"</span>)</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting residuals</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resid_long3, <span class="fu">aes</span>(<span class="at">x =</span> week_index, <span class="at">y =</span> residual, <span class="at">color =</span> model)) <span class="sc">+</span>   <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> model, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span>   </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(     </span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Residuals for All Models"</span>,     </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>,     </span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuals"</span>) <span class="sc">+</span>   </span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rmse-3" class="level4">
<h4 class="anchored" data-anchor-id="rmse-3">2.3.1.3. RMSE</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting RMSE values</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>rmse_summary3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span>    </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(          </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Poisson =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_poisson<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Negative Binomial</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_nb<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exponential =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_exp<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Polynomial =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_poly<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">GAM =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_gam<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lognormal =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_lognormal<span class="sc">^</span><span class="dv">2</span>)),          </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gamma =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(resid_gamma<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span>      </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Model"</span>, <span class="at">values_to =</span> <span class="st">"RMSE"</span>)  </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rmse_summary3, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Model, RMSE), <span class="at">y =</span> RMSE, <span class="at">fill =</span> Model)) <span class="sc">+</span>      </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>      </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RMSE, <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span>      </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(          </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"RMSE Comparison Across Models"</span>, </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Lower RMSE indicates better fit"</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>, <span class="at">y =</span> <span class="st">"RMSE"</span>) <span class="sc">+</span>      </span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cumulative-model-comparison-2" class="level3">
<h3 class="anchored" data-anchor-id="cumulative-model-comparison-2">2.3.2. Cumulative Model Comparison</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting Cumulative Models</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparation</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_cases       =</span> <span class="fu">cumsum</span>(cases),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_poisson     =</span> <span class="fu">cumsum</span>(fitted_poisson3),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_nb          =</span> <span class="fu">cumsum</span>(fitted_nb3),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_exp         =</span> <span class="fu">cumsum</span>(fitted_exp3),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_gam         =</span> <span class="fu">cumsum</span>(fitted_gam3),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_poly        =</span> <span class="fu">cumsum</span>(fitted_poly3),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_lognormal   =</span> <span class="fu">cumsum</span>(fitted_lognormal3),</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_gamma       =</span> <span class="fu">cumsum</span>(fitted_gamma3)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wave3, <span class="fu">aes</span>(<span class="at">x =</span> week_index)) <span class="sc">+</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_cases), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_poisson, <span class="at">color =</span> <span class="st">"Poisson"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_nb, <span class="at">color =</span> <span class="st">"Negative Binomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_exp, <span class="at">color =</span> <span class="st">"Exponential"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_gam, <span class="at">color =</span> <span class="st">"GAM"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_poly, <span class="at">color =</span> <span class="st">"Polynomial"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_lognormal, <span class="at">color =</span> <span class="st">"Lognormal"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative_gamma, <span class="at">color =</span> <span class="st">"Gamma"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cumulative Cases vs Model Fits"</span>,</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black dots = Actual || Lines = Fitted Cumulative Cases"</span>,</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>,</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Number of Cases"</span>,</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="residuals-5" class="level4">
<h4 class="anchored" data-anchor-id="residuals-5">2.3.2.1. Residuals</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting Cumulative Models’ residuals</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepatation</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_poisson =</span> cumulative_cases <span class="sc">-</span> cumulative_poisson,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_nb      =</span> cumulative_cases <span class="sc">-</span> cumulative_nb,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_exp     =</span> cumulative_cases <span class="sc">-</span> cumulative_exp,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_poly    =</span> cumulative_cases <span class="sc">-</span> cumulative_poly,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_gam     =</span> cumulative_cases <span class="sc">-</span> cumulative_gam,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_lognormal     =</span> cumulative_cases <span class="sc">-</span> cumulative_lognormal,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_cum_gamma   =</span> cumulative_cases <span class="sc">-</span> cumulative_gamma</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting to long format</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>resid_cum_long3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(week_index, resid_cum_poisson, resid_cum_nb, resid_cum_exp, resid_cum_poly, resid_cum_gam, resid_cum_lognormal, resid_cum_gamma) <span class="sc">%&gt;%</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"resid_cum"</span>),</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"model"</span>,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"cumulative_residual"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">recode</span>(model,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_poisson =</span> <span class="st">"Poisson"</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_nb =</span> <span class="st">"Negative Binomial"</span>,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_exp =</span> <span class="st">"Exponential"</span>,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_poly =</span> <span class="st">"Polynomial"</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_gam =</span> <span class="st">"GAM"</span>,</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_lognormal =</span> <span class="st">"Lognormal"</span>,</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resid_cum_gamma =</span> <span class="st">"Gamma"</span>))</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resid_cum_long3, <span class="fu">aes</span>(<span class="at">x =</span> week_index, <span class="at">y =</span> cumulative_residual, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> model, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cumulative Residuals by Model"</span>,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Week Index"</span>,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Residual (Actual - Fitted)"</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rmse-4" class="level4">
<h4 class="anchored" data-anchor-id="rmse-4">2.3.2.2. RMSE</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting Cumulative Models’ RMSE values</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparation</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>rmse_cum_poisson3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave3<span class="sc">$</span>resid_cum_poisson<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>rmse_cum_nb3      <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave3<span class="sc">$</span>resid_cum_nb<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>rmse_cum_exp3     <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave3<span class="sc">$</span>resid_cum_exp<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>rmse_cum_gam3     <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave3<span class="sc">$</span>resid_cum_gam<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>rmse_cum_poly3    <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave3<span class="sc">$</span>resid_cum_poly<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>rmse_cum_lognormal3    <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave3<span class="sc">$</span>resid_cum_lognormal<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>rmse_cum_gamma3   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(wave3<span class="sc">$</span>resid_cum_gamma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Put in a table</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>rmse_table3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Poisson"</span>, <span class="st">"Negative Binomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"GAM"</span>, <span class="st">"Polynomial"</span>, <span class="st">"Lognormal"</span>, <span class="st">"Gamma"</span>),</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE  =</span> <span class="fu">c</span>(rmse_cum_poisson3, rmse_cum_nb3, rmse_cum_exp3, rmse_cum_gam3, rmse_cum_poly3, rmse_cum_lognormal3, rmse_cum_gamma3)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rmse_table3, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Model, RMSE), <span class="at">y =</span> RMSE, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RMSE, <span class="dv">1</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"RMSE of Cumulative Cases by Model"</span>,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Lower RMSE indicates better fit"</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>,</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"RMSE"</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="progress-based-curve-fitting" class="level1">
<h1>3. Progress-based Curve fitting</h1>
<p>To see how well a model trained with 1 outbreak period would perform on the other outbreak period, we load <em>progress</em> with the proportion of cases instead of a fixed count. This will allow us to better compare the graph shape of the outbreak period with another outbreak period.</p>
<p>The models being compared in this segment will include GAM Model, Polynomial Model, Exponential Model, Negative Binomial Model and Poisson Model.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for obtaining Progress from 3 waves</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For Wave 1</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(week_index) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cum_cases =</span> <span class="fu">cumsum</span>(cases),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">progress =</span> cum_cases <span class="sc">/</span> <span class="fu">max</span>(cum_cases)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For Wave 2</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(week_index) <span class="sc">%&gt;%</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cum_cases =</span> <span class="fu">cumsum</span>(cases),</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">progress =</span> cum_cases <span class="sc">/</span> <span class="fu">max</span>(cum_cases)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co"># For Wave 3</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(week_index) <span class="sc">%&gt;%</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">cum_cases =</span> <span class="fu">cumsum</span>(cases),</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">progress =</span> cum_cases <span class="sc">/</span> <span class="fu">max</span>(cum_cases)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="using-2014-outbreak-wave-1" class="level2">
<h2 class="anchored" data-anchor-id="using-2014-outbreak-wave-1">3.1. Using 2014 Outbreak (Wave 1)</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code for fitting models using Wave 1’s data</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GAM model</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>gam_progress1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(cases <span class="sc">~</span> <span class="fu">s</span>(progress), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave1)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Polynomial model</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>poly_progress1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(progress, <span class="dv">4</span>), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave1)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential model (fit on log scale)</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>exp_progress1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> progress, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">data =</span> wave1)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative Binomial</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>nb_progress1 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(progress, <span class="dv">4</span>), <span class="at">data =</span> wave1)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>poisson_progress1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(progress, <span class="dv">4</span>), <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> wave1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We then attempt to predict the shape of Wave 2 and Wave 3 using the data from Wave 1.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for predicting Wave 2 and Wave 3</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict using Wave 1 models on Wave 2</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_gam1   =</span> <span class="fu">predict</span>(gam_progress1, <span class="at">newdata =</span> wave2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poly1  =</span> <span class="fu">predict</span>(poly_progress1, <span class="at">newdata =</span> wave2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_exp1   =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(exp_progress1, <span class="at">newdata =</span> wave2)) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_nb1 =</span> <span class="fu">predict</span>(nb_progress1, <span class="at">newdata =</span> wave2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poisson1 =</span> <span class="fu">predict</span>(poisson_progress1, <span class="at">newdata =</span> wave2, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict using Wave 1 models on Wave 3</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_gam1   =</span> <span class="fu">predict</span>(gam_progress1, <span class="at">newdata =</span> wave3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poly1  =</span> <span class="fu">predict</span>(poly_progress1, <span class="at">newdata =</span> wave3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_exp1   =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(exp_progress1, <span class="at">newdata =</span> wave3)) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_nb1 =</span> <span class="fu">predict</span>(nb_progress1, <span class="at">newdata =</span> wave3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poisson1 =</span> <span class="fu">predict</span>(poisson_progress1, <span class="at">newdata =</span> wave3, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The predicted values are then plotted in the same plot as the actual values for visual comparison.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting predicted and actual values of Wave 2 and Wave 3</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and label</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>wave1<span class="sc">$</span>wave <span class="ot">&lt;-</span> <span class="st">"Wave 1"</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>wave2<span class="sc">$</span>wave <span class="ot">&lt;-</span> <span class="st">"Wave 2"</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>wave3<span class="sc">$</span>wave <span class="ot">&lt;-</span> <span class="st">"Wave 3"</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>predicted_progress1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(wave1, wave2, wave3)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_progress1, <span class="fu">aes</span>(<span class="at">x =</span> progress)) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cases, <span class="at">color =</span> wave), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_gam1, <span class="at">color =</span> <span class="st">"GAM"</span>), <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_poly1, <span class="at">color =</span> <span class="st">"Polynomial"</span>), <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_exp1, <span class="at">color =</span> <span class="st">"Exponential"</span>), <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_nb1, <span class="at">color =</span> <span class="st">"Negative Binomial"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_poisson1, <span class="at">color =</span> <span class="st">"Poisson"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>wave, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted vs Actual Epidemic Shapes (by Progress)"</span>,</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Progress (0 to 1)"</span>,</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Weekly Cases"</span>,</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model / Wave"</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These steps are then repeated for the next two outbreak waves as well.</p>
</section>
<section id="using-2015-outbreak-wave-2" class="level2">
<h2 class="anchored" data-anchor-id="using-2015-outbreak-wave-2">3.2. Using 2015 Outbreak (Wave 2)</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code for fitting models using Wave 2’s data</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GAM model</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>gam_progress2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(cases <span class="sc">~</span> <span class="fu">s</span>(progress), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave2)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Polynomial model</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>poly_progress2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(progress, <span class="dv">4</span>), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave2)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential model (fit on log scale)</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>exp_progress2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> progress, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">data =</span> wave2)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative Binomial</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>nb_progress2 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(progress, <span class="dv">4</span>), <span class="at">data =</span> wave2)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>poisson_progress2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(progress, <span class="dv">4</span>), <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> wave2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for predicting Wave 1 and Wave 3</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on Wave 1</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_gam2       =</span> <span class="fu">predict</span>(gam_progress2, <span class="at">newdata =</span> wave1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poly2      =</span> <span class="fu">predict</span>(poly_progress2, <span class="at">newdata =</span> wave1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_exp2       =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(exp_progress2, <span class="at">newdata =</span> wave1)) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_nb2 =</span> <span class="fu">predict</span>(nb_progress2, <span class="at">newdata =</span> wave1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poisson2 =</span> <span class="fu">predict</span>(poisson_progress2, <span class="at">newdata =</span> wave1, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on Wave 3</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>wave3 <span class="ot">&lt;-</span> wave3 <span class="sc">%&gt;%</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_gam2       =</span> <span class="fu">predict</span>(gam_progress2, <span class="at">newdata =</span> wave3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poly2      =</span> <span class="fu">predict</span>(poly_progress2, <span class="at">newdata =</span> wave3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_exp2       =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(exp_progress2, <span class="at">newdata =</span> wave3)) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_nb2 =</span> <span class="fu">predict</span>(nb_progress2, <span class="at">newdata =</span> wave3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poisson2 =</span> <span class="fu">predict</span>(poisson_progress2, <span class="at">newdata =</span> wave3, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting predicted and actual values of Wave 1 and Wave 3</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine for plotting</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>wave1<span class="sc">$</span>wave <span class="ot">&lt;-</span> <span class="st">"Wave 1"</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>wave2<span class="sc">$</span>wave <span class="ot">&lt;-</span> <span class="st">"Wave 2"</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>wave3<span class="sc">$</span>wave <span class="ot">&lt;-</span> <span class="st">"Wave 3"</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>predicted_progress2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(wave1, wave2, wave3)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_progress2, <span class="fu">aes</span>(<span class="at">x =</span> progress)) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cases, <span class="at">color =</span> wave), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_gam2, <span class="at">color =</span> <span class="st">"GAM (from Wave 2)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_poly2, <span class="at">color =</span> <span class="st">"Polynomial (from Wave 2)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_exp2, <span class="at">color =</span> <span class="st">"Exponential (from Wave 2)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_nb2, <span class="at">color =</span> <span class="st">"Negative Binomial (Wave 2)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_poisson2, <span class="at">color =</span> <span class="st">"Poisson (Wave 2)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>wave, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predictions on Wave 1 &amp; 3 using Models Trained on Wave 2"</span>,</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Progress (0–1)"</span>,</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cases"</span>,</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model / Wave"</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-2023-outbreak-wave-3" class="level2">
<h2 class="anchored" data-anchor-id="using-2023-outbreak-wave-3">3.3. Using 2023 Outbreak (Wave 3)</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code for fitting models using Wave 3’s data</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GAM</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>gam_progress3 <span class="ot">&lt;-</span> <span class="fu">gam</span>(cases <span class="sc">~</span> <span class="fu">s</span>(progress), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave3)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Polynomial</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>poly_progress3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(progress, <span class="dv">4</span>), <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> wave3)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential (log scale)</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>exp_progress3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(cases <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> progress, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">data =</span> wave3)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative Binomial</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>nb_progress3 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(progress, <span class="dv">4</span>), <span class="at">data =</span> wave3)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>poisson_progress3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">poly</span>(progress, <span class="dv">4</span>), <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> wave3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for predicting Wave 1 and Wave 2</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>wave1 <span class="ot">&lt;-</span> wave1 <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_gam3      =</span> <span class="fu">predict</span>(gam_progress3, <span class="at">newdata =</span> wave1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poly3     =</span> <span class="fu">predict</span>(poly_progress3, <span class="at">newdata =</span> wave1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_exp3      =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(exp_progress3, <span class="at">newdata =</span> wave1)) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_nb3 =</span> <span class="fu">predict</span>(nb_progress3, <span class="at">newdata =</span> wave1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poisson3 =</span> <span class="fu">predict</span>(poisson_progress3, <span class="at">newdata =</span> wave1, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>wave2 <span class="ot">&lt;-</span> wave2 <span class="sc">%&gt;%</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_gam3      =</span> <span class="fu">predict</span>(gam_progress3, <span class="at">newdata =</span> wave2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poly3     =</span> <span class="fu">predict</span>(poly_progress3, <span class="at">newdata =</span> wave2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_exp3      =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(exp_progress3, <span class="at">newdata =</span> wave2)) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_nb3 =</span> <span class="fu">predict</span>(nb_progress3, <span class="at">newdata =</span> wave2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_poisson3 =</span> <span class="fu">predict</span>(poisson_progress3, <span class="at">newdata =</span> wave2, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code for plotting predicted and actual values of Wave 1 and Wave 2</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>wave1<span class="sc">$</span>wave <span class="ot">&lt;-</span> <span class="st">"Wave 1"</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>wave2<span class="sc">$</span>wave <span class="ot">&lt;-</span> <span class="st">"Wave 2"</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>wave3<span class="sc">$</span>wave <span class="ot">&lt;-</span> <span class="st">"Wave 3"</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>predicted_progress3 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(wave1, wave2, wave3)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_progress3, <span class="fu">aes</span>(<span class="at">x =</span> progress)) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cases, <span class="at">color =</span> wave), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_gam3, <span class="at">color =</span> <span class="st">"GAM (from Wave 3)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_poly3, <span class="at">color =</span> <span class="st">"Polynomial (from Wave 3)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_exp3, <span class="at">color =</span> <span class="st">"Exponential (from Wave 3)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_nb3, <span class="at">color =</span> <span class="st">"Negative Binomial (Wave 3)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"twodash"</span>) <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_poisson3, <span class="at">color =</span> <span class="st">"Poisson (Wave 3)"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>wave, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predictions on Wave 1 &amp; 2 using Models Trained on Wave 3"</span>,</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Progress (0–1)"</span>,</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cases"</span>,</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model / Wave"</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cumulative-model-comparison-using-rmse" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-model-comparison-using-rmse">3.4. Cumulative Model Comparison using RMSE</h2>
<p>A function of RMSE is created to reduce the troublesome steps of obtaining the RMSE values.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for RMSE function</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(actual, predicted) {</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">mean</span>((actual <span class="sc">-</span> predicted)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="predicting-2014-outbreak" class="level3">
<h3 class="anchored" data-anchor-id="predicting-2014-outbreak">3.4.1. Predicting 2014 Outbreak</h3>
<p>We then compare the RMSE of the predicted values against the actual values when the models are trained using the different waves. For example, we look at Wave 2’s and Wave 3’s predicted values against Wave 1’s actual values and see which model is better at predicting these values.</p>
<p>The same is repeated for the other outbreak periods.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code for predicting the 2014 Outbreak</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fit_metrics231 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"GAM"</span>, <span class="st">"Polynomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"Negative</span><span class="sc">\n</span><span class="st">Binomial"</span>, <span class="st">"Poisson"</span>), <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">c</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_gam2),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_poly2),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_exp2),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_nb2),</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_poisson2),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_gam3),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_poly3),</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_exp3),</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_nb3),</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave1<span class="sc">$</span>cases, wave1<span class="sc">$</span>pred_poisson3)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wave =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Wave 2"</span>, <span class="st">"Wave 3"</span>), <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side-by-side bars</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_metrics231, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> RMSE, <span class="at">fill =</span> Wave)) <span class="sc">+</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RMSE, <span class="dv">2</span>)), </span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), </span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"RMSE of Models (Wave 2 vs Wave 3)"</span>,</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>,</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"RMSE"</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="predicting-2015-outbreak" class="level3">
<h3 class="anchored" data-anchor-id="predicting-2015-outbreak">3.4.2. Predicting 2015 Outbreak</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code for predicting the 2015 Outbreak</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fit_metrics132 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"GAM"</span>, <span class="st">"Polynomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"Negative</span><span class="sc">\n</span><span class="st">Binomial"</span>, <span class="st">"Poisson"</span>), <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">c</span>(</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_gam1),</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_poly1),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_exp1),</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_nb1),</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_poisson1),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_gam3),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_poly3),</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_exp3),</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_nb3),</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave2<span class="sc">$</span>cases, wave2<span class="sc">$</span>pred_poisson3)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wave =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Wave 1"</span>, <span class="st">"Wave 3"</span>), <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side-by-side bars</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_metrics132, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> RMSE, <span class="at">fill =</span> Wave)) <span class="sc">+</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RMSE, <span class="dv">2</span>)), </span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), </span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"RMSE of Models (Wave 1 vs Wave 3)"</span>,</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>,</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"RMSE"</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="predicting-2023-outbreak" class="level3">
<h3 class="anchored" data-anchor-id="predicting-2023-outbreak">3.4.3. Predicting 2023 Outbreak</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code for predicting the 2023 Outbreak</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>fit_metrics123 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"GAM"</span>, <span class="st">"Polynomial"</span>, <span class="st">"Exponential"</span>, <span class="st">"Negative</span><span class="sc">\n</span><span class="st">Binomial"</span>, <span class="st">"Poisson"</span>), <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">c</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_gam1),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_poly1),</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_exp1),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_nb1),</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_poisson1),</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_gam2),</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_poly2),</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_exp2),</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_nb2),</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(wave3<span class="sc">$</span>cases, wave3<span class="sc">$</span>pred_poisson2)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wave =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Wave 1"</span>, <span class="st">"Wave 2"</span>), <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side-by-side bars</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_metrics123, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> RMSE, <span class="at">fill =</span> Wave)) <span class="sc">+</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RMSE, <span class="dv">2</span>)), </span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), </span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"RMSE of Models (Wave 1 vs Wave 2)"</span>,</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Model"</span>,</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"RMSE"</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="time_series_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>